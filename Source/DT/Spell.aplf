 text←pattern Spell JJJ;nonzero
⍝ Format a date or timestamp (based on a Julian Day Number) into a specified format.
⍝ Since this routine depends on 1200⌶ all data (except the constant 0) must follow
⍝ its range restrictions.

 JJJ←0.5-⍨(,nonzero←(JJJ≠0)∧~JJJ∊⎕NULL)/,JJJ ⍝ Format zeros as ''
 text←(⍴nonzero)⍴1↓(1,,nonzero)\(⊂''),pattern(1200⌶)50 1 ⎕DT JJJ
 :If 0=≡nonzero ⋄ text←⊃text ⋄ :EndIf ⍝ Don't enclose scalar results
